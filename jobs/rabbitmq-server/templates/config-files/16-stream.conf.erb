<% if_p('rabbitmq-server.plugins') do |plugins| %>
<% if plugins.include?('rabbitmq_stream') && p('rabbitmq-server.version') != "3.8" %>
  
<% if p('rabbitmq-server.ssl.enabled') %>
stream.listeners.ssl.default = 5551
<% if p('rabbitmq-server.ssl.disable_non_ssl_listeners') %>
stream.listeners.tcp = none
<% end -%>
<% end -%>

<% if p('rabbitmq-server.stream.advertised_host') != "" %>
stream.advertised_host = <%= p('rabbitmq-server.stream.advertised_host') %>
<% end -%>

<% if p('rabbitmq-server.stream.advertised_port') != "" %>
stream.advertised_port = <%= p('rabbitmq-server.stream.advertised_port') %>
<% end -%>

<% if p('rabbitmq-server.stream.advertised_tls_port') != "" %>
stream.advertised_tls_port = <%= p('rabbitmq-server.stream.advertised_tls_port') %>
<% end -%>

<% end -%>
<% end -%>
